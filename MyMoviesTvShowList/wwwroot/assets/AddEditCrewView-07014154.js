var D=Object.defineProperty;var y=(n,e,l)=>e in n?D(n,e,{enumerable:!0,configurable:!0,writable:!0,value:l}):n[e]=l;var i=(n,e,l)=>(y(n,typeof e!="symbol"?e+"":e,l),l);import{d as F,r as p,a as S,n as C,o as h,c as g,i as V,q as x,g as a,h as m,v as d,f as b,k as L}from"./index-a18159e2.js";import{u as E,c as k}from"./crewparams-97cd5103.js";import{u as U}from"./globalhelper-7d76c8d7.js";import{_ as A}from"./AdminNavigationComponent.vue_vue_type_script_setup_true_lang-041ab717.js";class w{constructor(){i(this,"Id");i(this,"FirstName");i(this,"LastName");i(this,"BirthDate");i(this,"BirthPlace");i(this,"PersonImage");this.Id=0,this.FirstName="",this.LastName="",this.BirthDate="",this.BirthPlace="",this.PersonImage=new Blob}}const q={key:0,class:"text-center mt-5"},M={class:"form-group mb-3"},G=["onSubmit"],R={class:"form-group mb-3"},T={class:"form-group mb-3"},H={class:"form-group mb-3"},O={class:"form-group mb-3"},Q={class:"form-group mb-3"},W={class:"form-group mb-3"},$=["src"],j=a("button",{type:"submit",class:"btn w-25"},"Save person",-1),Z=F({__name:"AddEditCrewView",setup(n){const e=p(new w),l=p(),u=E(),I=U(),r=S(()=>u.EditPerson),c=p(),v=p(),_=s=>{if(e.value.PersonImage=s.target.files[0],e.value.PersonImage&&e.value.PersonImage.type.startsWith("image/")){const t=new FileReader;t.onload=o=>{l.value=o.target.result},t.readAsDataURL(e.value.PersonImage)}};C(()=>{v.value=u.isEdit,P()});const P=()=>{if(r.value!=null){e.value.Id=r.value.Id,e.value.FirstName=r.value.FirstName,e.value.LastName=r.value.LastName,e.value.BirthPlace=r.value.BirthPlace,r.value.PersonImageData!=null&&(l.value="data:image/png;base64,"+r.value.PersonImageData);const s=I.formatInputDate(new Date(r.value.BirthDate));e.value.BirthDate=s,u.setEditPerson(void 0),u.setIsEdit(!1)}},f=()=>{e.value=new w,l.value=null,v.value=!1,c.value=""},B=async()=>{const s=new FormData;s.append("Id",e.value.Id.toString()),s.append("FirstName",e.value.FirstName),s.append("LastName",e.value.LastName),s.append("BirthDate",e.value.BirthDate),s.append("BirthPlace",e.value.BirthPlace),s.append("PersonImage",e.value.PersonImage),u.SavePerson(s).then(()=>{f()})},N=async()=>{await u.GetPersonFromAPI(c.value),P()};return(s,t)=>(h(),g("div",null,[V(A,{routes:x(k)},null,8,["routes"]),v.value?b("",!0):(h(),g("div",q,[a("div",M,[m(a("input",{type:"text","onUpdate:modelValue":t[0]||(t[0]=o=>c.value=o),class:"w-50",id:"query",placeholder:"Search for celebritie..."},null,512),[[d,c.value]])]),a("button",{class:"btn",onClick:N},"Search")])),a("form",{onSubmit:L(B,["prevent"]),class:"text-center mb-3 mt-5"},[a("div",R,[m(a("input",{type:"text","onUpdate:modelValue":t[1]||(t[1]=o=>e.value.FirstName=o),class:"w-50",id:"name",placeholder:"Name"},null,512),[[d,e.value.FirstName]])]),a("div",T,[m(a("input",{type:"text","onUpdate:modelValue":t[2]||(t[2]=o=>e.value.LastName=o),class:"w-50",id:"lastname",placeholder:"Surname"},null,512),[[d,e.value.LastName]])]),a("div",H,[m(a("input",{type:"date","onUpdate:modelValue":t[3]||(t[3]=o=>e.value.BirthDate=o),class:"w-50",id:"surname",placeholder:"Birth Date"},null,512),[[d,e.value.BirthDate]])]),a("div",O,[m(a("input",{type:"text","onUpdate:modelValue":t[4]||(t[4]=o=>e.value.BirthPlace=o),class:"w-50",id:"surname",placeholder:"Birth Place"},null,512),[[d,e.value.BirthPlace]])]),a("div",Q,[a("input",{type:"file",onChange:_,class:"w-50",id:"surname",placeholder:"Insert person image",accept:"image/*"},null,32)]),a("div",W,[l.value?(h(),g("img",{key:0,src:l.value,alt:"Image Preview"},null,8,$)):b("",!0)]),a("button",{type:"button",class:"btn w-25 mr-1",onClick:f},"Clear"),j],40,G)]))}});export{Z as default};
