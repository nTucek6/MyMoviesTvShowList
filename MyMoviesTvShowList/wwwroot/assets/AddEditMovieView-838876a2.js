var P=Object.defineProperty;var $=(i,o,d)=>o in i?P(i,o,{enumerable:!0,configurable:!0,writable:!0,value:d}):i[o]=d;var u=(i,o,d)=>($(i,typeof o!="symbol"?o+"":o,d),d);import{d as O,r,a as x,y as T,o as c,c as v,i as _,q as g,g as l,h as p,v as m,f as F,F as j,s as H,k as J,t as z,p as K,l as Q,_ as X}from"./index-a18159e2.js";import{u as Y}from"./moviesadmin-6e261063.js";import{s as S}from"./default.css_vue_type_style_index_1_src_true_lang-94eb8ea2.js";import{u as Z}from"./globalhelper-7d76c8d7.js";import{_ as ee}from"./AdminNavigationComponent.vue_vue_type_script_setup_true_lang-041ab717.js";import{m as ae}from"./moviesparams-cc211dca.js";class E{constructor(){u(this,"Id");u(this,"MovieName");u(this,"Synopsis");u(this,"Genres");u(this,"Director");u(this,"Writers");u(this,"Actors");u(this,"ReleaseDate");u(this,"Duration");u(this,"MovieImageData");this.Id=0,this.MovieName="",this.Synopsis="",this.Genres="",this.Director="",this.Writers="",this.Actors="",this.ReleaseDate="",this.Duration=0,this.MovieImageData=new Blob([])}}const te=i=>(K("data-v-fc8bed5e"),i=i(),Q(),i),le={key:0,class:"text-center mt-5"},se={class:"form-group mb-3"},oe={key:0,class:"lds-dual-ring"},re=["onSubmit"],ne={class:"form-group mb-3"},ie={class:"form-group mb-3"},ue={class:"form-group mb-3"},de={class:"form-group mb-3"},ce={class:"form-group mb-3"},ve={class:"form-group mb-3"},pe={class:"form-group mb-3"},me={class:"form-group mb-3"},fe={class:"form-group mb-3"},De=["onUpdate:modelValue"],he=["onUpdate:modelValue"],_e={class:"form-group mb-3"},ge={class:"form-group mb-3"},ye=["src"],be=te(()=>l("button",{type:"submit",class:"btn w-25"},"Save movie",-1)),we=O({__name:"AddEditMovieView",setup(i){const o=Y(),d=Z(),t=r(new E),y=r(),b=r(),w=r(),D=r(),h=r(),I=r(),V=r(),N=r(),C=r(),q=x(()=>o.Genres),M=r(),A=r(!1),G=r(!1),n=x(()=>o.EditMovie);T(async()=>{await o.GetGenres(),U()});const U=()=>{if(n.value!=null){A.value=!0,t.value.Id=n.value.Id,t.value.MovieName=n.value.MovieName,t.value.Duration=n.value.Duration,t.value.Synopsis=n.value.Synopsis,n.value.Genres.map(e=>I.value.select(e.value)),n.value.Director.map(e=>V.value.select({value:e.Id,label:e.FirstName+" "+e.LastName})),n.value.Writers.map(e=>N.value.select({value:e.Id,label:e.FirstName+" "+e.LastName})),n.value.Actors.map(e=>C.value.select({value:e.Id,label:e.FirstName+" "+e.LastName,CharacterName:e.CharacterName,Description:e.CharacterDescription})),n.value.MovieImageData!=null&&(h.value="data:image/png;base64,"+n.value.MovieImageData);const s=d.formatInputDate(new Date(n.value.ReleaseDate));t.value.ReleaseDate=s,o.setEditMovie(void 0)}},k=async s=>{if(s!=null){await o.GetCrew(s);const e=x(()=>o.MovieCrew);if(e.value!=null)return e.value.map(a=>({value:a.value,label:a.label}))}return null},B=s=>{if(t.value.MovieImageData=s.target.files[0],t.value.MovieImageData&&t.value.MovieImageData.type.startsWith("image/")){const e=new FileReader;e.onload=a=>{h.value=a.target.result},e.readAsDataURL(t.value.MovieImageData)}},R=()=>{t.value=new E,h.value=null,y.value=null,b.value=null,w.value=null,D.value=null,I.value.clear(),V.value.clear(),N.value.clear(),C.value.clear(),M.value="",A.value=!1},L=async()=>{const s=new FormData;s.append("Id",t.value.Id.toString()),s.append("MovieName",t.value.MovieName),s.append("Duration",t.value.Duration.toString()),s.append("Synopsis",t.value.Synopsis),s.append("Genres",y.value.map(e=>e)),s.append("ReleaseDate",t.value.ReleaseDate),s.append("Director",b.value.map(e=>e)),s.append("Writers",w.value.map(e=>e)),s.append("Actors",JSON.stringify(D.value)),s.append("MovieImageData",t.value.MovieImageData),o.SaveMovie(s).then(()=>{R()})},W=async()=>{G.value=!0,await o.GetMovieFromAPI(M.value),U(),G.value=!1};return(s,e)=>(c(),v("div",null,[_(ee,{routes:g(ae)},null,8,["routes"]),A.value?F("",!0):(c(),v("div",le,[l("div",se,[p(l("input",{type:"text","onUpdate:modelValue":e[0]||(e[0]=a=>M.value=a),class:"w-50",id:"query",placeholder:"Search for movie..."},null,512),[[m,M.value]])]),G.value?(c(),v("div",oe)):(c(),v("button",{key:1,class:"btn",onClick:W},"Search"))])),l("form",{onSubmit:J(L,["prevent"]),class:"text-center mb-3 mt-5"},[l("div",ne,[p(l("input",{type:"text","onUpdate:modelValue":e[1]||(e[1]=a=>t.value.MovieName=a),class:"w-50",id:"title",placeholder:"Movie title"},null,512),[[m,t.value.MovieName]])]),l("div",ie,[p(l("input",{type:"text","onUpdate:modelValue":e[2]||(e[2]=a=>t.value.Duration=a),class:"w-50",id:"title",placeholder:"Duration"},null,512),[[m,t.value.Duration]])]),l("div",ue,[p(l("textarea",{type:"text","onUpdate:modelValue":e[3]||(e[3]=a=>t.value.Synopsis=a),class:"w-50",id:"title",placeholder:"Synopsis"},null,512),[[m,t.value.Synopsis]])]),l("div",de,[p(l("input",{type:"date","onUpdate:modelValue":e[4]||(e[4]=a=>t.value.ReleaseDate=a),class:"w-50",id:"title",placeholder:"Release date"},null,512),[[m,t.value.ReleaseDate]])]),l("div",ce,[_(g(S),{placeholder:"Select genres...",modelValue:y.value,"onUpdate:modelValue":e[5]||(e[5]=a=>y.value=a),options:q.value,mode:"tags","close-on-select":!1,searchable:!0,"create-option":!0,"preselect-first":!0,ref_key:"GenresDefault",ref:I},null,8,["modelValue","options"])]),l("div",ve,[_(g(S),{modelValue:b.value,"onUpdate:modelValue":e[6]||(e[6]=a=>b.value=a),mode:"tags",placeholder:"Search director...","close-on-select":!1,"filter-results":!1,"min-chars":1,"resolve-on-load":!1,delay:1e3,searchable:!0,ref_key:"DirectorDefault",ref:V,options:async function(a,f){return await k(a)}},null,8,["modelValue","options"])]),l("div",pe,[_(g(S),{placeholder:"Select screenwriter...",modelValue:w.value,"onUpdate:modelValue":e[7]||(e[7]=a=>w.value=a),mode:"tags","close-on-select":!1,"filter-results":!1,"min-chars":1,"resolve-on-load":!1,delay:1e3,searchable:!0,ref_key:"ScreenwriterDefault",ref:N,options:async function(a,f){return await k(a)}},null,8,["modelValue","options"])]),l("div",me,[_(g(S),{placeholder:"Select actors...",modelValue:D.value,"onUpdate:modelValue":e[8]||(e[8]=a=>D.value=a),mode:"tags","close-on-select":!1,"filter-results":!1,"min-chars":1,"resolve-on-load":!1,delay:1e3,searchable:!0,object:!0,ref_key:"ActorsDefault",ref:C,options:async function(a,f){return await k(a)}},null,8,["modelValue","options"])]),l("div",fe,[(c(!0),v(j,null,H(D.value,a=>(c(),v("div",{key:a.value},[l("label",null,z(a.label),1),p(l("input",{type:"text",class:"w-50 ml-2",placeholder:"Character name...","onUpdate:modelValue":f=>a.CharacterName=f,required:""},null,8,De),[[m,a.CharacterName]]),p(l("textarea",{class:"w-50 ml-2 mt-2",placeholder:"Description...","onUpdate:modelValue":f=>a.Description=f,required:""},null,8,he),[[m,a.Description]])]))),128))]),l("div",_e,[l("input",{type:"file",onChange:B,class:"w-50",id:"surname",placeholder:"Insert movie image"},null,32)]),l("div",ge,[h.value?(c(),v("img",{key:0,src:h.value,alt:"Image Preview"},null,8,ye)):F("",!0)]),l("button",{type:"button",class:"btn w-25 mr-1",onClick:R},"Clear"),be],40,re)]))}});const Ge=X(we,[["__scopeId","data-v-fc8bed5e"]]);export{Ge as default};
